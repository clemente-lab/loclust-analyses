/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/statsmodels/tsa/base/tsa_model.py:7: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.
  from pandas import (to_datetime, Int64Index, DatetimeIndex, Period,
/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/statsmodels/tsa/base/tsa_model.py:7: FutureWarning: pandas.Float64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.
  from pandas import (to_datetime, Int64Index, DatetimeIndex, Period,
Continuing with legacy script...


⚠️  DEPRECATION WARNING: Direct script usage is deprecated!
Please use the unified CLI instead:
  loclust cluster [OPTIONS] INPUT_FILE
Example: loclust cluster data.tsv --method k-means --clusters 3
Run 'loclust cluster --help' for more information

cwd: /sc/arion/projects/CVDlung/earl/loclust/simulations/2b_cluster_minimal_features
dir_out: /sc/arion/projects/CVDlung/earl/loclust/simulations/data_minimal_features/input_trajs/8/9/clustering/spectral_k9/spectral_k9
True
...reading data

0 trajectories dropped for being too short. 1800 trajs remaining.

...rescaling trajectories

(0.0, 100.0)

...calculating loClust statistics

Pre-processing Configuration:
{'input_filename': None, 'rescale_flag': True, 'rescale_group_flag': False, 'pca_flag': True, 'factor_analysis_flag': False, 'transform_trajs_flag': False, 'factor_corr_flag': False, 'cos_sim_flag': False}
...calculating PCA decomposition

Using fixed 9 PCA components (user-specified)
Final: 9 PCA components explaining 90.8% of variance
/sc/arion/projects/CVDlung/earl/loclust/simulations/data_minimal_features/input_trajs/8/9/clustering/spectral_k9/spectral_k9
/sc/arion/projects/CVDlung/earl/loclust/simulations/data_minimal_features/input_trajs/8/9/clustering/spectral_k9/0.2noise.exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan.200reps.2.clust.tsv
Clustering rounds:   0%|          | 0/10 [00:00<?, ?it/s]/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:379: ConvergenceWarning: Number of distinct clusters (2) found smaller than n_clusters (9). Possibly due to duplicate points in X.
  est = KMeans(
Clustering rounds:  10%|█         | 1/10 [00:00<00:07,  1.14it/s]/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:379: ConvergenceWarning: Number of distinct clusters (2) found smaller than n_clusters (9). Possibly due to duplicate points/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:259: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/cluster/_kme
/sc/arion/projects/CVDlung/earl/loclust/loclust/plot.py:647: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly clo/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:259: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:379: ConvergenceWarning: Number of distinct clusters (2) found smaller than n_clusters (9). Possibly due to duplicate points in X.
  est = KMeans(
Clustering rounds:  30%|███       | 3/10 [00:21<00:49,  7.06s/it]/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:259: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:379: ConvergenceWarning: Number of distinct clusters (2) found smaller than n_clusters (9). Possibly due to duplicate points in X.
  est = KMeans(
Clustering rounds:  40%|████      | 4/10 [00:29<00:45,  7.63s/it]/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:259: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:379: ConvergenceWarning: Number of distinct clusters (2) found smaller than n_clusters (9). Possibly due to duplicate points in X.
  est = KMeans(
Clustering rounds:  50%|█████     | 5/10 [00:36<00:36,  7.38s/it]/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:259: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:379: ConvergenceWarning: Number of distinct clusters (2) found smaller than n_clusters (9). Possibly due to duplicate points in X.
  est = KMeans(
Clustering rounds:  60%|██████    | 6/10 [00:44<00:29,  7.46s/it]/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:259: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:379: ConvergenceWarning: Number of distinct clusters (2) found smaller than n_clusters (9). Possibly due to duplicate points in X.
  est = KMeans(
Clustering rounds:  70%|███████   | 7/10 [00:49<00:20,  6.76s/it]/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:259: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:379: ConvergenceWarning: Number of distinct clusters (2) found smaller than n_clusters (9). Possibly due to duplicate points in X.
  est = KMeans(
Clustering rounds:  80%|████████  | 8/10 [00:58<00:14,  7.36s/it]/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:259: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:379: ConvergenceWarning: Number of distinct clusters (2) found smaller than n_clusters (9). Possibly due to duplicate points in X.
  est = KMeans(
Clustering rounds:  90%|█████████ | 9/10 [01:04<00:06,  6.86s/it]/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/manifold/_spectral_embedding.py:259: UserWarning: Graph is not fully connected, spectral embedding may not work as expected.
  warnings.warn(
/hpc/packages/minerva-centos7/py_packages/3.8/lib/python3.8/site-packages/sklearn/cluster/_kmeans.py:379: ConvergenceWarning: Number of distinct clusters (2) found smaller than n_clusters (9). Possibly due to duplicate points in X.
  est = KMeans(
Clustering rounds: 100%|██████████| 10/10 [01:11<00:00,  7.07s/it]Clustering rounds: 100%|██████████| 10/10 [01:11<00:00,  7.17s/it]
/sc/arion/projects/CVDlung/earl/loclust/loclust/plot.py:647: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure()
...performing clustering analysis with method spectral 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method spectral 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method spectral 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method spectral 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method spectral 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method spectral 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method spectral 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method spectral 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method spectral 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method spectral 

Using forced k=9 (skipping optimization)
PCAplot_filename: 
/sc/arion/projects/CVDlung/earl/loclust/simulations/data_minimal_features/input_trajs/8/9/clustering/spectral_k9/0.12noise.exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan.200reps.2.clust.tsv
/sc/arion/projects/CVDlung/earl/loclust/simulations/data_minimal_features/input_trajs/8/9/clustering/spectral_k9/spectral_k9
Writing to: /sc/arion/projects/CVDlung/earl/loclust/simulations/data_minimal_features/input_trajs/8/9/clustering/spectral_k9/0.12noise.exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan.200reps.2.clust.tsv
...Cluster analysis complete.
no plots flag: True

Continuing with legacy script...

/home/ewa/.local/share/mamba/lib/python3.11/site-packages/numpy/lib/_function_base_impl.py:3065: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/home/ewa/.local/share/mamba/lib/python3.11/site-packages/numpy/lib/_function_base_impl.py:3066: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]

⚠️  DEPRECATION WARNING: Direct script usage is deprecated!
Please use the unified CLI instead:
  loclust cluster [OPTIONS] INPUT_FILE
Example: loclust cluster data.tsv --method k-means --clusters 3
Run 'loclust cluster --help' for more information

cwd: /home/ewa/Dropbox/mssm_research/loclust/simulations/clustering_scripts
dir_out: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/3_classes/exponential-linear-sin/noise_0.04/seed_042/clustering/gmm_k3/gmm_k3
True
...reading data

0 trajectories dropped for being too short. 150 trajs remaining.

...performing adaptive interpolation
   - Target points: 100
   - Threshold: 20 points (PCHIP < 20, LOWESS >= 20)
   - Interpolated 150 trajectories:
     • PCHIP (sparse): 0 trajectories
     • LOWESS (dense): 150 trajectories

...rescaling trajectories

(0.0, 100.0)

...calculating loClust statistics

Pre-processing Configuration:
{'input_filename': None, 'rescale_flag': True, 'rescale_group_flag': False, 'pca_flag': True, 'factor_analysis_flag': False, 'transform_trajs_flag': False, 'factor_corr_flag': False, 'cos_sim_flag': False}
...calculating PCA decomposition

Using elbow method for optimal PCA component selection...

PCA Component Selection (Elbow Method):
  Eigenvalue analysis: 52 total components available
  Method 1 (variance drop <2%):  8 components
  Method 2 (cumulative >93%):    10 components
  Selected (median):             9 components
  Variance explained:            91.68%
  Individual component variance: [0.30999093 0.17491095 0.12980947 0.10900545 0.06510768 0.0490854
 0.03372298 0.02545416 0.01969499]
Final: 9 PCA components explaining 91.7% of variance
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/3_classes/exponential-linear-sin/noise_0.04/seed_042/clustering/gmm_k3/gmm_k3
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/3_classes/exponential-linear-sin/noise_0.04/seed_042/clustering/gmm_k3/trajectories.clust.tsv
Clustering rounds:   0%|          | 0/10 [00:00<?, ?it/s]Clustering rounds:  10%|█         | 1/10 [00:00<00:02,  3.28it/s]Clustering rounds:  20%|██        | 2/10 [00:00<00:02,  4.00it/s]Clustering rounds:  30%|███       | 3/10 [00:00<00:01,  4.13it/s]Clustering rounds:  40%|████      | 4/10 [00:00<00:01,  4.57it/s]Clustering rounds:  50%|█████     | 5/10 [00:01<00:01,  4.83it/s]Clustering rounds:  60%|██████    | 6/10 [00:01<00:00,  4.95it/s]Clustering rounds:  70%|███████   | 7/10 [00:01<00:00,  5.05it/s]Clustering rounds:  80%|████████  | 8/10 [00:01<00:00,  4.82it/s]Clustering rounds:  90%|█████████ | 9/10 [00:01<00:00,  4.44it/s]Clustering rounds: 100%|██████████| 10/10 [00:02<00:00,  4.73it/s]Clustering rounds: 100%|██████████| 10/10 [00:02<00:00,  4.60it/s]
/home/ewa/Dropbox/mssm_research/loclust/loclust/plot.py:647: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure()
...performing clustering analysis with method gmm 

Using forced k=3 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=3 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=3 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=3 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=3 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=3 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=3 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=3 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=3 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=3 (skipping optimization)
PCAplot_filename: 
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/3_classes/exponential-linear-sin/noise_0.04/seed_042/clustering/gmm_k3/trajectories.clust.tsv
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/3_classes/exponential-linear-sin/noise_0.04/seed_042/clustering/gmm_k3/gmm_k3
Writing to: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/3_classes/exponential-linear-sin/noise_0.04/seed_042/clustering/gmm_k3/trajectories.clust.tsv
...Cluster analysis complete.
no plots flag: None
Plotting clusters.
True
Plot Trajectories
Plot cluster line. True key func
[-1.54586305 -0.87520412 -0.20454518  0.46611375  1.13677269  1.80743162
  2.47809055  3.14874949  3.81940842  4.49006736  5.16072629  5.83138523
  6.50204416  7.1727031   7.84336203  8.51402096  9.1846799   9.85533883
 10.52599777 11.1966567 ]
purity
[[0, 0.23809523809523808], [1, 0.2698412698412698], [2, 0.49206349206349204]]
[-0.92399784 -0.12085256  0.68229273  1.48543801  2.28858329  3.09172858
  3.89487386  4.69801914  5.50116443  6.30430971  7.10745499  7.91060028
  8.71374556  9.51689084 10.32003613 11.12318141 11.92632669 12.72947198
 13.53261726 14.33576255]
purity
[[0, 0.43137254901960786], [1, 0.27450980392156865], [2, 0.29411764705882354]]
[-0.34906585  0.57656681  1.50219947  2.42783214  3.3534648   4.27909746
  5.20473013  6.13036279  7.05599545  7.98162811  8.90726078  9.83289344
 10.7585261  11.68415876 12.60979143 13.53542409 14.46105675 15.38668941
 16.31232208 17.23795474]
purity
[[0, 0.3611111111111111], [1, 0.5277777777777778], [2, 0.1111111111111111]]
Trajectories plotted
Found 3 clusters: [np.int64(0), np.int64(1), np.int64(2)]
Plotted 51 trajectories in cluster 0
Plotted 36 trajectories in cluster 1
Plotted 63 trajectories in cluster 2
Plotted 51 interpolated trajectories in cluster 0
Plotted 36 interpolated trajectories in cluster 1
Plotted 63 interpolated trajectories in cluster 2
Comprehensive cluster summary plot saved to: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/3_classes/exponential-linear-sin/noise_0.04/seed_042/clustering/gmm_k3/gmm_k3/cluster_summary.png
Confusion matrix saved to: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/3_classes/exponential-linear-sin/noise_0.04/seed_042/clustering/gmm_k3/gmm_k3/confusion_matrix.png
LoClust Clustering Log
Method: gmm
k (fixed): 3
Dataset: 3_classes/exponential-linear-sin/noise_0.04/seed_042
Started: 2025-10-08T19:00:00.094414
Command: python /home/ewa/Dropbox/mssm_research/loclust/scripts/cluster_trajectories.py -fi trajectories.tsv -di /home/ewa/Dropbox/mssm_research/loclust/simulations/data/3_classes/exponential-linear-sin/noise_0.04/seed_042 -fo /home/ewa/Dropbox/mssm_research/loclust/simulations/data/3_classes/exponential-linear-sin/noise_0.04/seed_042/clustering/gmm_k3/trajectories.clust.tsv -do /home/ewa/Dropbox/mssm_research/loclust/simulations/data/3_classes/exponential-linear-sin/noise_0.04/seed_042/clustering/gmm_k3 -c gmm -tk func -ak cluster --force-k 3 -rs 42 --write_flag --pca_flag

================================================================================


================================================================================
Completed: 2025-10-08T19:00:17.653242
Duration: 0:00:17.558828
Status: SUCCESS

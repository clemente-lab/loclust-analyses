Continuing with legacy script...

/home/ewa/.local/share/mamba/lib/python3.11/site-packages/numpy/lib/_function_base_impl.py:3065: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]

⚠️  DEPRECATION WARNING: Direct script usage is deprecated!
Please use the unified CLI instead:
  loclust cluster [OPTIONS] INPUT_FILE
Example: loclust cluster data.tsv --method k-means --clusters 3
Run 'loclust cluster --help' for more information

cwd: /home/ewa/Dropbox/mssm_research/loclust/simulations/clustering_scripts
dir_out: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/9_classes/exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan/noise_0.04/seed_042/clustering/gmm_k9/gmm_k9
True
...reading data

0 trajectories dropped for being too short. 450 trajs remaining.

...performing adaptive interpolation
   - Target points: 100
   - Threshold: 20 points (PCHIP < 20, LOWESS >= 20)
   - Interpolated 450 trajectories:
     • PCHIP (sparse): 0 trajectories
     • LOWESS (dense): 450 trajectories

...rescaling trajectories

(0.0, 100.0)

...calculating loClust statistics

Pre-processing Configuration:
{'input_filename': None, 'rescale_flag': True, 'rescale_group_flag': False, 'pca_flag': True, 'factor_analysis_flag': False, 'transform_trajs_flag': False, 'factor_corr_flag': False, 'cos_sim_flag': False}
...calculating PCA decomposition

Using elbow method for optimal PCA component selection...

PCA Component Selection (Elbow Method):
  Eigenvalue analysis: 52 total components available
  Method 1 (variance drop <2%):  10 components
  Method 2 (cumulative >93%):    13 components
  Selected (median):             11 components
  Variance explained:            91.03%
  Individual component variance: [0.29067637 0.19174827 0.11622539 0.06977605 0.06038298 0.04682887
 0.04203657 0.02781806 0.02686807 0.02081534 0.01717   ]
Final: 11 PCA components explaining 91.0% of variance
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/9_classes/exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan/noise_0.04/seed_042/clustering/gmm_k9/gmm_k9
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/9_classes/exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan/noise_0.04/seed_042/clustering/gmm_k9/trajectories.clust.tsv
Clustering rounds:   0%|          | 0/10 [00:00<?, ?it/s]Clustering rounds:  10%|█         | 1/10 [00:01<00:09,  1.01s/it]Clustering rounds:  20%|██        | 2/10 [00:01<00:07,  1.11it/s]Clustering rounds:  30%|███       | 3/10 [00:02<00:06,  1.07it/s]Clustering rounds:  40%|████      | 4/10 [00:03<00:05,  1.11it/s]Clustering rounds:  50%|█████     | 5/10 [00:04<00:04,  1.09it/s]Clustering rounds:  60%|██████    | 6/10 [00:05<00:03,  1.15it/s]Clustering rounds:  70%|███████   | 7/10 [00:06<00:02,  1.17it/s]Clustering rounds:  80%|████████  | 8/10 [00:07<00:01,  1.13it/s]Clustering rounds:  90%|█████████ | 9/10 [00:07<00:00,  1.16it/s]Clustering rounds: 100%|██████████| 10/10 [00:08<00:00,  1.15it/s]Clustering rounds: 100%|██████████| 10/10 [00:08<00:00,  1.13it/s]
/home/ewa/Dropbox/mssm_research/loclust/loclust/plot.py:647: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure()
...performing clustering analysis with method gmm 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=9 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=9 (skipping optimization)
PCAplot_filename: 
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/9_classes/exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan/noise_0.04/seed_042/clustering/gmm_k9/trajectories.clust.tsv
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/9_classes/exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan/noise_0.04/seed_042/clustering/gmm_k9/gmm_k9
Writing to: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/9_classes/exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan/noise_0.04/seed_042/clustering/gmm_k9/trajectories.clust.tsv
...Cluster analysis complete.
no plots flag: None
Plotting clusters.
True
Plot Trajectories
Plot cluster line. True key func
[-0.16631961  0.73354066  1.63340093  2.53326119  3.43312146  4.33298173
  5.232842    6.13270227  7.03256254  7.93242281  8.83228308  9.73214334
 10.63200361 11.53186388 12.43172415 13.33158442 14.23144469 15.13130496
 16.03116522 16.93102549]
purity
[[0, 0.4117647058823529], [3, 0.058823529411764705], [5, 0.35294117647058826], [6, 0.058823529411764705], [8, 0.11764705882352941]]
[-0.48071784  0.34574611  1.17221005  1.998674    2.82513795  3.65160189
  4.47806584  5.30452979  6.13099373  6.95745768  7.78392163  8.61038558
  9.43684952 10.26331347 11.08977742 11.91624136 12.74270531 13.56916926
 14.3956332  15.22209715]
purity
[[0, 0.1896551724137931], [3, 0.12931034482758622], [4, 0.20689655172413793], [5, 0.14655172413793102], [6, 0.10344827586206896], [7, 0.09482758620689655], [8, 0.12931034482758622]]
[-1.94453752 -1.56743557 -1.19033362 -0.81323166 -0.43612971 -0.05902776
  0.3180742   0.69517615  1.0722781   1.44938006  1.82648201  2.20358396
  2.58068592  2.95778787  3.33488982  3.71199178  4.08909373  4.46619568
  4.84329764  5.22039959]
purity
[[0, 0.13793103448275862], [1, 0.034482758620689655], [8, 0.3793103448275862], [7, 0.4482758620689655]]
[-0.04039191  0.93528845  1.9109688   2.88664915  3.8623295   4.83800985
  5.8136902   6.78937055  7.7650509   8.74073125  9.7164116  10.69209196
 11.66777231 12.64345266 13.61913301 14.59481336 15.57049371 16.54617406
 17.52185441 18.49753476]
purity
[[0, 0.22857142857142856], [3, 0.17142857142857143], [4, 0.05714285714285714], [5, 0.11428571428571428], [6, 0.4], [8, 0.02857142857142857]]
[ 0.  1.  2.  3.  4.  5.  6.  7.  8.  9. 10. 11. 12. 13. 14. 15. 16. 17.
 18. 19.]
purity
[[0, 0.0364963503649635], [1, 0.22627737226277372], [2, 0.3284671532846715], [3, 0.16058394160583941], [5, 0.12408759124087591], [6, 0.12408759124087591]]
[-1.30830799 -0.71006505 -0.1118221   0.48642085  1.08466379  1.68290674
  2.28114969  2.87939263  3.47763558  4.07587853  4.67412147  5.27236442
  5.87060737  6.46885031  7.06709326  7.66533621  8.26357915  8.8618221
  9.46006505 10.05830799]
purity
[[0, 0.013157894736842105], [1, 0.09210526315789473], [3, 0.02631578947368421], [4, 0.3157894736842105], [6, 0.013157894736842105], [7, 0.3157894736842105], [8, 0.2236842105263158]]
[-1.13882734 -0.51895078  0.10092579  0.72080235  1.34067891  1.96055547
  2.58043203  3.2003086   3.82018516  4.44006172  5.05993828  5.67981484
  6.2996914   6.91956797  7.53944453  8.15932109  8.77919765  9.39907421
 10.01895078 10.63882734]
purity
[[0, 0.375], [1, 0.125], [8, 0.25], [7, 0.25]]
[ 0.  1.  2.  3.  4.  5.  6.  7.  8.  9. 10. 11. 12. 13. 14. 15. 16. 17.
 18. 19.]
purity
[[1, 1.0]]
[-0.12293189  0.80305179  1.72903547  2.65501914  3.58100282  4.5069865
  5.43297017  6.35895385  7.28493753  8.21092121  9.13690488 10.06288856
 10.98887224 11.91485591 12.84083959 13.76682327 14.69280694 15.61879062
 16.5447743  17.47075797]
purity
[[1, 0.043478260869565216], [2, 0.21739130434782608], [3, 0.17391304347826086], [5, 0.2608695652173913], [6, 0.21739130434782608], [8, 0.08695652173913043]]
Trajectories plotted
Found 9 clusters: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8)]
Plotted 23 trajectories in cluster 0
Plotted 116 trajectories in cluster 1
Plotted 137 trajectories in cluster 2
Plotted 29 trajectories in cluster 3
Plotted 8 trajectories in cluster 4
Plotted 9 trajectories in cluster 5
Plotted 35 trajectories in cluster 6
Plotted 76 trajectories in cluster 7
Plotted 17 trajectories in cluster 8
Plotted 23 interpolated trajectories in cluster 0
Plotted 116 interpolated trajectories in cluster 1
Plotted 137 interpolated trajectories in cluster 2
Plotted 29 interpolated trajectories in cluster 3
Plotted 8 interpolated trajectories in cluster 4
Plotted 9 interpolated trajectories in cluster 5
Plotted 35 interpolated trajectories in cluster 6
Plotted 76 interpolated trajectories in cluster 7
Plotted 17 interpolated trajectories in cluster 8
Comprehensive cluster summary plot saved to: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/9_classes/exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan/noise_0.04/seed_042/clustering/gmm_k9/gmm_k9/cluster_summary.png
Confusion matrix saved to: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/9_classes/exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan/noise_0.04/seed_042/clustering/gmm_k9/gmm_k9/confusion_matrix.png
LoClust Clustering Log
Method: gmm
k (fixed): 9
Dataset: 9_classes/exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan/noise_0.04/seed_042
Started: 2025-10-08T19:09:15.486936
Command: python /home/ewa/Dropbox/mssm_research/loclust/scripts/cluster_trajectories.py -fi trajectories.tsv -di /home/ewa/Dropbox/mssm_research/loclust/simulations/data/9_classes/exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan/noise_0.04/seed_042 -fo /home/ewa/Dropbox/mssm_research/loclust/simulations/data/9_classes/exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan/noise_0.04/seed_042/clustering/gmm_k9/trajectories.clust.tsv -do /home/ewa/Dropbox/mssm_research/loclust/simulations/data/9_classes/exponential-growth-hyperbolic-linear-norm-poly-scurve-sin-tan/noise_0.04/seed_042/clustering/gmm_k9 -c gmm -tk func -ak cluster --force-k 9 -rs 42 --write_flag --pca_flag

================================================================================


================================================================================
Completed: 2025-10-08T19:10:02.871246
Duration: 0:00:47.384310
Status: SUCCESS

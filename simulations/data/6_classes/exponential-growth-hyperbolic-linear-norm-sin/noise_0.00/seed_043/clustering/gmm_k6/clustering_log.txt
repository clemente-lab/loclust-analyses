Continuing with legacy script...

/home/ewa/.local/share/mamba/lib/python3.11/site-packages/numpy/lib/_function_base_impl.py:3065: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]

⚠️  DEPRECATION WARNING: Direct script usage is deprecated!
Please use the unified CLI instead:
  loclust cluster [OPTIONS] INPUT_FILE
Example: loclust cluster data.tsv --method k-means --clusters 3
Run 'loclust cluster --help' for more information

cwd: /home/ewa/Dropbox/mssm_research/loclust/simulations/clustering_scripts
dir_out: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.00/seed_043/clustering/gmm_k6/gmm_k6
True
...reading data

0 trajectories dropped for being too short. 300 trajs remaining.

...performing adaptive interpolation
   - Target points: 100
   - Threshold: 20 points (PCHIP < 20, LOWESS >= 20)
   - Interpolated 300 trajectories:
     • PCHIP (sparse): 0 trajectories
     • LOWESS (dense): 300 trajectories

...rescaling trajectories

(0.0, 100.0)

...calculating loClust statistics

Pre-processing Configuration:
{'input_filename': None, 'rescale_flag': True, 'rescale_group_flag': False, 'pca_flag': True, 'factor_analysis_flag': False, 'transform_trajs_flag': False, 'factor_corr_flag': False, 'cos_sim_flag': False}
...calculating PCA decomposition

Using elbow method for optimal PCA component selection...

PCA Component Selection (Elbow Method):
  Eigenvalue analysis: 52 total components available
  Method 1 (variance drop <2%):  10 components
  Method 2 (cumulative >93%):    11 components
  Selected (median):             10 components
  Variance explained:            91.66%
  Individual component variance: [0.28011428 0.2327298  0.13752731 0.06252067 0.05752288 0.03577931
 0.03482039 0.02941509 0.02598743 0.0202062 ]
Final: 10 PCA components explaining 91.7% of variance
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.00/seed_043/clustering/gmm_k6/gmm_k6
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.00/seed_043/clustering/gmm_k6/trajectories.clust.tsv
Clustering rounds:   0%|          | 0/10 [00:00<?, ?it/s]Clustering rounds:  10%|█         | 1/10 [00:00<00:05,  1.73it/s]Clustering rounds:  20%|██        | 2/10 [00:01<00:04,  1.93it/s]Clustering rounds:  30%|███       | 3/10 [00:01<00:03,  1.92it/s]Clustering rounds:  40%|████      | 4/10 [00:02<00:02,  2.01it/s]Clustering rounds:  50%|█████     | 5/10 [00:02<00:02,  2.00it/s]Clustering rounds:  60%|██████    | 6/10 [00:03<00:02,  1.92it/s]Clustering rounds:  70%|███████   | 7/10 [00:03<00:01,  1.84it/s]Clustering rounds:  80%|████████  | 8/10 [00:04<00:01,  1.80it/s]Clustering rounds:  90%|█████████ | 9/10 [00:04<00:00,  1.92it/s]Clustering rounds: 100%|██████████| 10/10 [00:05<00:00,  2.07it/s]Clustering rounds: 100%|██████████| 10/10 [00:05<00:00,  1.95it/s]
/home/ewa/Dropbox/mssm_research/loclust/loclust/plot.py:647: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure()
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
PCAplot_filename: 
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.00/seed_043/clustering/gmm_k6/trajectories.clust.tsv
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.00/seed_043/clustering/gmm_k6/gmm_k6
Writing to: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.00/seed_043/clustering/gmm_k6/trajectories.clust.tsv
...Cluster analysis complete.
no plots flag: None
Plotting clusters.
True
Plot Trajectories
Plot cluster line. True key func
[ 0.  1.  2.  3.  4.  5.  6.  7.  8.  9. 10. 11. 12. 13. 14. 15. 16. 17.
 18. 19.]
purity
[[0, 0.4], [3, 0.23076923076923078], [4, 0.36923076923076925]]
[ 0.  1.  2.  3.  4.  5.  6.  7.  8.  9. 10. 11. 12. 13. 14. 15. 16. 17.
 18. 19.]
purity
[[0, 0.5581395348837209], [1, 0.09302325581395349], [3, 0.32558139534883723], [4, 0.023255813953488372]]
[-0.23444721  0.71560458  1.66565636  2.61570815  3.56575994  4.51581173
  5.46586352  6.41591531  7.36596709  8.31601888  9.26607067 10.21612246
 11.16617425 12.11622604 13.06627782 14.01632961 14.9663814  15.91643319
 16.86648498 17.81653677]
purity
[[1, 0.22388059701492538], [2, 0.373134328358209], [3, 0.1417910447761194], [4, 0.1865671641791045], [5, 0.07462686567164178]]
[ 0.  1.  2.  3.  4.  5.  6.  7.  8.  9. 10. 11. 12. 13. 14. 15. 16. 17.
 18. 19.]
purity
[[1, 1.0]]
[-2.84706834 -2.45362694 -2.06018553 -1.66674413 -1.27330272 -0.87986132
 -0.48641992 -0.09297851  0.30046289  0.6939043   1.0873457   1.48078711
  1.87422851  2.26766992  2.66111132  3.05455272  3.44799413  3.84143553
  4.23487694  4.62831834]
purity
[[1, 0.09375], [5, 0.90625]]
[-2.65827071 -2.22460658 -1.79094246 -1.35727834 -0.92361421 -0.48995009
 -0.05628597  0.37737815  0.81104228  1.2447064   1.67837052  2.11203465
  2.54569877  2.97936289  3.41302702  3.84669114  4.28035526  4.71401938
  5.14768351  5.58134763]
purity
[[3, 0.15384615384615385], [5, 0.8461538461538461]]
Trajectories plotted
Found 6 clusters: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5)]
Plotted 32 trajectories in cluster 0
Plotted 134 trajectories in cluster 1
Plotted 65 trajectories in cluster 2
Plotted 13 trajectories in cluster 3
Plotted 43 trajectories in cluster 4
Plotted 13 trajectories in cluster 5
Plotted 32 interpolated trajectories in cluster 0
Plotted 134 interpolated trajectories in cluster 1
Plotted 65 interpolated trajectories in cluster 2
Plotted 13 interpolated trajectories in cluster 3
Plotted 43 interpolated trajectories in cluster 4
Plotted 13 interpolated trajectories in cluster 5
Comprehensive cluster summary plot saved to: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.00/seed_043/clustering/gmm_k6/gmm_k6/cluster_summary.png
Confusion matrix saved to: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.00/seed_043/clustering/gmm_k6/gmm_k6/confusion_matrix.png
LoClust Clustering Log
Method: gmm
k (fixed): 6
Dataset: 6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.00/seed_043
Started: 2025-10-08T19:05:49.581924
Command: python /home/ewa/Dropbox/mssm_research/loclust/scripts/cluster_trajectories.py -fi trajectories.tsv -di /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.00/seed_043 -fo /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.00/seed_043/clustering/gmm_k6/trajectories.clust.tsv -do /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.00/seed_043/clustering/gmm_k6 -c gmm -tk func -ak cluster --force-k 6 -rs 42 --write_flag --pca_flag

================================================================================


================================================================================
Completed: 2025-10-08T19:06:21.845486
Duration: 0:00:32.263562
Status: SUCCESS

Continuing with legacy script...

/home/ewa/.local/share/mamba/lib/python3.11/site-packages/numpy/lib/_function_base_impl.py:3065: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]

⚠️  DEPRECATION WARNING: Direct script usage is deprecated!
Please use the unified CLI instead:
  loclust cluster [OPTIONS] INPUT_FILE
Example: loclust cluster data.tsv --method k-means --clusters 3
Run 'loclust cluster --help' for more information

cwd: /home/ewa/Dropbox/mssm_research/loclust/simulations/clustering_scripts
dir_out: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.04/seed_042/clustering/gmm_k6/gmm_k6
True
...reading data

0 trajectories dropped for being too short. 300 trajs remaining.

...performing adaptive interpolation
   - Target points: 100
   - Threshold: 20 points (PCHIP < 20, LOWESS >= 20)
   - Interpolated 300 trajectories:
     • PCHIP (sparse): 0 trajectories
     • LOWESS (dense): 300 trajectories

...rescaling trajectories

(0.0, 100.0)

...calculating loClust statistics

Pre-processing Configuration:
{'input_filename': None, 'rescale_flag': True, 'rescale_group_flag': False, 'pca_flag': True, 'factor_analysis_flag': False, 'transform_trajs_flag': False, 'factor_corr_flag': False, 'cos_sim_flag': False}
...calculating PCA decomposition

Using elbow method for optimal PCA component selection...

PCA Component Selection (Elbow Method):
  Eigenvalue analysis: 52 total components available
  Method 1 (variance drop <2%):  10 components
  Method 2 (cumulative >93%):    12 components
  Selected (median):             11 components
  Variance explained:            92.89%
  Individual component variance: [0.29601763 0.19649847 0.1071568  0.08650023 0.06503121 0.05003847
 0.03746188 0.03082038 0.02690363 0.02057274 0.01194145]
Final: 11 PCA components explaining 92.9% of variance
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.04/seed_042/clustering/gmm_k6/gmm_k6
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.04/seed_042/clustering/gmm_k6/trajectories.clust.tsv
Clustering rounds:   0%|          | 0/10 [00:00<?, ?it/s]Clustering rounds:  10%|█         | 1/10 [00:00<00:06,  1.48it/s]Clustering rounds:  20%|██        | 2/10 [00:01<00:04,  1.62it/s]Clustering rounds:  30%|███       | 3/10 [00:01<00:04,  1.59it/s]Clustering rounds:  40%|████      | 4/10 [00:02<00:03,  1.62it/s]Clustering rounds:  50%|█████     | 5/10 [00:03<00:03,  1.41it/s]Clustering rounds:  60%|██████    | 6/10 [00:04<00:02,  1.40it/s]Clustering rounds:  70%|███████   | 7/10 [00:04<00:01,  1.54it/s]Clustering rounds:  80%|████████  | 8/10 [00:05<00:01,  1.47it/s]Clustering rounds:  90%|█████████ | 9/10 [00:06<00:00,  1.49it/s]Clustering rounds: 100%|██████████| 10/10 [00:06<00:00,  1.43it/s]Clustering rounds: 100%|██████████| 10/10 [00:06<00:00,  1.48it/s]
/home/ewa/Dropbox/mssm_research/loclust/loclust/plot.py:647: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure()
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
...performing clustering analysis with method gmm 

Using forced k=6 (skipping optimization)
PCAplot_filename: 
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.04/seed_042/clustering/gmm_k6/trajectories.clust.tsv
/home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.04/seed_042/clustering/gmm_k6/gmm_k6
Writing to: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.04/seed_042/clustering/gmm_k6/trajectories.clust.tsv
...Cluster analysis complete.
no plots flag: None
Plotting clusters.
True
Plot Trajectories
Plot cluster line. True key func
[ 0.  1.  2.  3.  4.  5.  6.  7.  8.  9. 10. 11. 12. 13. 14. 15. 16. 17.
 18. 19.]
purity
[[0, 0.875], [3, 0.125]]
[-0.51642619  0.3735509   1.26352799  2.15350508  3.04348217  3.93345926
  4.82343635  5.71341344  6.60339053  7.49336762  8.38334471  9.2733218
 10.16329889 11.05327598 11.94325307 12.83323016 13.72320725 14.61318434
 15.50316143 16.39313852]
purity
[[0, 0.3013698630136986], [3, 0.2054794520547945], [4, 0.3287671232876712], [5, 0.1643835616438356]]
[-1.19163859 -0.4455133   0.300612    1.0467373   1.79286259  2.53898789
  3.28511319  4.03123848  4.77736378  5.52348908  6.26961437  7.01573967
  7.76186497  8.50799026  9.25411556 10.00024085 10.74636615 11.49249145
 12.23861674 12.98474204]
purity
[[0, 0.14942528735632185], [1, 0.08045977011494253], [3, 0.09195402298850575], [4, 0.2988505747126437], [5, 0.3793103448275862]]
[-0.05463639  0.9337235   1.9220834   2.91044329  3.89880319  4.88716308
  5.87552298  6.86388287  7.85224277  8.84060266  9.82896256 10.81732245
 11.80568235 12.79404224 13.78240214 14.77076203 15.75912193 16.74748182
 17.73584172 18.72420161]
purity
[[0, 0.043478260869565216], [1, 0.28695652173913044], [2, 0.4260869565217391], [3, 0.22608695652173913], [5, 0.017391304347826087]]
[-1.17809725 -0.42908701  0.31992323  1.06893346  1.8179437   2.56695394
  3.31596417  4.06497441  4.81398465  5.56299488  6.31200512  7.06101535
  7.81002559  8.55903583  9.30804606 10.0570563  10.80606654 11.55507677
 12.30408701 13.05309725]
purity
[[0, 0.375], [1, 0.125], [2, 0.125], [5, 0.375]]
[ 0.  1.  2.  3.  4.  5.  6.  7.  8.  9. 10. 11. 12. 13. 14. 15. 16. 17.
 18. 19.]
purity
[[1, 1.0]]
Trajectories plotted
Found 6 clusters: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5)]
Plotted 87 trajectories in cluster 0
Plotted 115 trajectories in cluster 1
Plotted 8 trajectories in cluster 2
Plotted 73 trajectories in cluster 3
Plotted 8 trajectories in cluster 4
Plotted 9 trajectories in cluster 5
Plotted 87 interpolated trajectories in cluster 0
Plotted 115 interpolated trajectories in cluster 1
Plotted 8 interpolated trajectories in cluster 2
Plotted 73 interpolated trajectories in cluster 3
Plotted 8 interpolated trajectories in cluster 4
Plotted 9 interpolated trajectories in cluster 5
Comprehensive cluster summary plot saved to: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.04/seed_042/clustering/gmm_k6/gmm_k6/cluster_summary.png
Confusion matrix saved to: /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.04/seed_042/clustering/gmm_k6/gmm_k6/confusion_matrix.png
LoClust Clustering Log
Method: gmm
k (fixed): 6
Dataset: 6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.04/seed_042
Started: 2025-10-08T19:06:21.845696
Command: python /home/ewa/Dropbox/mssm_research/loclust/scripts/cluster_trajectories.py -fi trajectories.tsv -di /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.04/seed_042 -fo /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.04/seed_042/clustering/gmm_k6/trajectories.clust.tsv -do /home/ewa/Dropbox/mssm_research/loclust/simulations/data/6_classes/exponential-growth-hyperbolic-linear-norm-sin/noise_0.04/seed_042/clustering/gmm_k6 -c gmm -tk func -ak cluster --force-k 6 -rs 42 --write_flag --pca_flag

================================================================================


================================================================================
Completed: 2025-10-08T19:06:57.154538
Duration: 0:00:35.308842
Status: SUCCESS
